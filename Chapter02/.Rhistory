lines(dnbinom(seq(1, max(X)), r, p), col="sienna", lwd=2)
}
for (p in c(0.01, 0.1, 0.5)) {
X = rnbinom(N, r, p)
hist(X, freq=FALSE, main=paste("Negative Binomial with p=", p, sep=""))
lines(dnbinom(seq(1, max(X)), r, p), col="sienna", lwd=2)
}
avg
mean
center
emean
tmean
range
mrange
X = rnbinom(N, r, p)
tmean = r*(1-p)/p
tstd = sqrt(r*(1-p)/p^2)
mrange = round(seq(max(0, tmean - 3*tstd), tmean + 3*tstd, 1))
mrange
pnbinom(mrange, r, p)
prob = pnbinom(mrange, r, p)
par(mfrow=c(1,3))
for (p in c(0.01, 0.1, 0.5)) {
tmean = r*(1-p)/p
tstd = sqrt(r*(1-p)/p^2)
mrange = round(seq(max(0, tmean - 3*tstd), tmean + 3*tstd, 1))
prob = pnbinom(mrange, r, p)
X = rep(0, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
hist(X, freq=FALSE, main=paste("Negative Binomial with p=", p, sep=""))
lines(dnbinom(seq(1, max(X)), r, p), col="sienna", lwd=2)
}
### (c)
N = 1000
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(0, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = density(mrange, p)
X = rep(0, N)
for (i in 1:N) {
u = unif(1)
X[i] = mrange[1] + sum(prob < u)
}
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, max(X)), p), col="sienna", lwd=2)
}
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(0, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = density(mrange, p)
X = rep(0, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, max(X)), p), col="sienna", lwd=2)
}
prob
tmean
tvar
mrange
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = density(mrange, p)
X = rep(0, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, max(X)), p), col="sienna", lwd=2)
}
mrange
prob
cumsum(prob)
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(0, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, max(X)), p), col="sienna", lwd=2)
}
### (c)
N = 100000
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(0, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, max(X)), p), col="sienna", lwd=2)
}
### (c)
N = 1000
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(0, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, max(X)), p), col="sienna", lwd=2)
}
tmean
tvar
tstd
mrange
density(1, 0.5)
### (c)
N = 100000
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(0, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, max(X)), p), col="sienna", lwd=2)
}
prob
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(1, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, max(X)), p), col="sienna", lwd=2)
}
### (c)
N = 1000
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(1, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, max(X)), p), col="sienna", lwd=2)
}
X
hist(X)
hist(X, freq=F)
sum(X == 1)
sum(X < 2)
sum(X < 3)
sum(X < 4)
sum(X < 5)
sum(X < 6)
hist(X)
hist(X, freq=FALSE)
hist(X)
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(1, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
hist(X, freq=FALSE, breaks=c(0, max(X)), main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, max(X)), p), col="sienna", lwd=2)
}
X
hist(X)
hist(X, freq=F)
hist(X, freq=F, breaks=seq(0, 5))
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(1, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
hist(X, freq=FALSE, breaks=seq(0, max(X)) main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, max(X)), p), col="sienna", lwd=2)
}
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(1, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
hist(X, freq=FALSE, breaks=seq(0, max(X)), main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, max(X)), p), col="sienna", lwd=2)
}
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(1, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
M = max(X)
hist(X, freq=FALSE, breaks=seq(0, M, M/11), main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, M), p), col="sienna", lwd=2)
}
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(1, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
M = max(X)
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, M), p), col="sienna", lwd=2)
}
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(1, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
M = max(X)
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, M), p), col="sienna", lwd=2)
}
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(1, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
M = max(X)
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, M), p), col="sienna", lwd=2)
}
X
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(1, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
M = max(X)
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, M), p), col="sienna", lwd=2)
}
hist(X, freq=FALSE, breaks=seq(0, 5))
## 2.14
### (b)
N = 1000
r = 10
par(mfrow=c(1,3))
for (p in c(0.01, 0.1, 0.5)) {
tmean = r*(1-p)/p
tstd = sqrt(r*(1-p)/p^2)
mrange = round(seq(max(0, tmean - 3*tstd), tmean + 3*tstd, 1))
prob = pnbinom(mrange, r, p)
X = rep(0, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
hist(X, freq=FALSE, main=paste("Negative Binomial with p=", p, sep=""))
lines(dnbinom(seq(1, max(X)), r, p), col="sienna", lwd=2)
}
### (c)
N = 1000
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(1, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
M = max(X)
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, M), p), col="sienna", lwd=2)
}
hist(X, freq=FALSE, breaks=seq(0, 5))
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(1, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
M = max(X)
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, M), p), col="sienna", lwd=2)
}
### (c)
N = 100000
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(1, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
M = max(X)
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, M), p), col="sienna", lwd=2)
}
X
sum(X < 2)
density(1, p)
hist(X, breaks=5)
hist(X, breaks=6, freq=F)
hist(X, breaks=seq(0, 5), freq=F)
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(1, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
M = max(X)
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, M), p), col="sienna", lwd=2)
}
### (c)
N = 1000
par(mfrow=c(1, 3))
for (p in c(0.001, 0.01, 0.5)) {
tmean = -(1-p)/(p*log(p))
tvar = -(1-p)/(p^2*log(p)) - tmean^2
tstd = sqrt(tvar)
mrange = round(seq(max(1, tmean - 3*tstd), tmean + 3*tstd, 1))
density = function(x, p) {
-(1-p)^x/(x*log(p))
}
prob = cumsum(density(mrange, p))
X = rep(1, N)
for (i in 1:N) {
u = runif(1)
X[i] = mrange[1] + sum(prob < u)
}
M = max(X)
hist(X, freq=FALSE, main=paste("Logarithmic Series with p=", p, sep=""))
lines(density(seq(1, M), p), col="sienna", lwd=2)
}
install.packages("fs")
q()
